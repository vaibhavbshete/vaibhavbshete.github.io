<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plane Scroll</title>
    <style>
        body{
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        .fixed-window{
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            scroll-behavior: smooth;
        }
        .overflow-y-auto{
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div data-reference-frame class="overflow-y-auto fixed-window">
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Numquam illum excepturi reiciendis at ipsa reprehenderit dolor alias blanditiis ducimus non voluptate natus, eveniet debitis. Laborum autem beatae molestias voluptatibus voluptatum dolore eos nobis libero eaque accusantium, natus similique quasi quos ratione, soluta placeat commodi maxime repellat pariatur neque repudiandae perferendis? Nam quasi quam culpa labore a quos at voluptates, corporis aperiam sunt magnam illo? Consequatur laboriosam fugit quae quasi repudiandae! Veritatis excepturi quidem officiis at rem, reprehenderit minima quibusdam consequatur fuga error suscipit veniam? Temporibus error consequatur exercitationem suscipit cum perferendis, accusamus enim minus voluptates, iusto officiis voluptas eos optio expedita vero facilis consectetur dicta, quia ut reprehenderit quas velit fugiat totam laboriosam! Eligendi aperiam, praesentium neque nesciunt, vero enim inventore nobis provident odio modi expedita dolorum voluptatum officia error exercitationem incidunt et esse voluptates ullam numquam deserunt quibusdam? Nisi eius itaque nihil veniam voluptate sunt, incidunt molestiae exercitationem voluptatum nulla sapiente non, veritatis laboriosam enim. Rem sit dolorum aspernatur vitae tempora quae quasi accusamus optio, tempore veritatis et distinctio nostrum, quia vel labore ad ipsum dolores quo quas neque autem maiores dicta repellat odio? Ea excepturi dolorum magnam beatae illum libero nobis vel, atque, ullam ducimus mollitia pariatur nemo.
        <div class="">
            <svg style="height: 200px;margin-left: -200px;" data-image-iteration="1" fill="none" viewBox="0 0 1457 240" xmlns="http://www.w3.org/2000/svg">
                <path data-path="1" transform="translate(0,100)" d="M1 95C292 95 327.5 1 682 1C1036.5 1 1112.5 95 1456 95" style="stroke:#109C74;stroke-width:2px;stroke-miterlimit:10;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:12,12;" />
                <g data-transform-group="plane" filter="drop-shadow(10px 10px 10px rgba(0, 0, 0, 0.2))">
                    <g transform="scale(0.5),translate(-208,88),rotate(8)">
                        <path d="M71.0003 78.4277L118.186 140.669L406.34 50.1171" fill="#2A2A2A"/>
                        <path d="M411.27 50.3718C294.997 42.0136 178.823 33.6483 62.5493 25.29C65.4019 43.0336 68.1477 60.6844 71.0004 78.4279L411.27 50.3718Z" fill="#E7E7E7"/>
                        <path d="M69.0586 109.24C49.6984 131.855 30.3381 154.47 10.9779 177.085C144.44 134.812 277.908 92.6381 411.27 50.3719L69.0586 109.24Z" fill="#FEFEFE"/>
                    </g>
                </g>
            </svg>
        </div>
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Commodi earum, consequuntur quidem quae in ab, reprehenderit error autem adipisci provident eveniet nihil quis id repellat eum labore est dolorem nam. Tenetur non iste accusantium, optio illum eos sit consequatur nobis, provident voluptate, rerum ad impedit dolore alias facere nihil. Vel quas quod, vitae numquam magni eius? Facere quam, possimus vitae nisi mollitia numquam natus officiis velit. Sapiente harum consequuntur ullam quo labore porro, natus dolores reiciendis necessitatibus rem corrupti ducimus omnis! Tempore ea culpa voluptatem beatae eos, iure suscipit totam dicta veritatis dolor enim ut, vero laborum. Odit inventore sapiente hic quia, suscipit provident et perspiciatis quidem distinctio corporis culpa, autem omnis, nostrum necessitatibus maxime id esse rerum accusamus sit fuga magni animi nisi? Odit sit non natus vero similique, distinctio saepe, harum ratione aliquid porro ipsum sed et rem perspiciatis eius, consequuntur vel aperiam dignissimos voluptas qui. Ipsam sed eius exercitationem distinctio odio quod error, ad sapiente sunt ducimus? Dignissimos voluptatum rerum sapiente laborum doloremque optio dolorum suscipit ducimus impedit neque? Iusto necessitatibus facilis placeat dolor, optio et a! Molestias aspernatur sunt assumenda officia. Labore maxime aliquam libero, voluptates est ratione saepe eius necessitatibus incidunt, culpa aperiam molestias corporis consectetur obcaecati reprehenderit! Dignissimos, dolorem voluptates. Praesentium commodi distinctio a ipsa ipsum nemo, ducimus, quo autem expedita sapiente, facere magni repellat aspernatur corrupti inventore voluptas odit? Quo quae numquam aliquam rem, facilis facere alias hic quos rerum perferendis illum incidunt ea eaque modi nostrum a. Dolores cum commodi aliquam, ipsam dignissimos aliquid vero, dolor minus saepe accusantium corporis cumque nisi! Voluptas, eligendi omnis eum numquam accusamus officiis sit aperiam quisquam obcaecati ipsam ut corrupti dignissimos iste ducimus modi alias autem et consectetur perferendis exercitationem veritatis, voluptatibus architecto. Voluptatibus dolorum sunt voluptatem commodi officiis culpa architecto doloribus animi explicabo vel placeat odio sit, repellat nihil voluptate provident qui deleniti iusto! Autem reprehenderit fuga eos, consectetur ex doloremque repudiandae tenetur ducimus cumque possimus officiis voluptas. Dignissimos nisi mollitia exercitationem, odit debitis repellat non consequatur voluptate fugiat quam enim nihil perspiciatis et vitae vero blanditiis? Quasi molestiae omnis pariatur libero! Fuga hic ipsum dolorem incidunt in adipisci itaque soluta, voluptatibus nobis doloribus tempore architecto quasi dignissimos, alias debitis culpa deserunt aut labore repudiandae beatae fugiat tenetur doloremque consequatur? Qui nihil officiis non voluptatem possimus, nesciunt, vel tempore maiores, obcaecati fuga molestiae earum eveniet! Rem quaerat dignissimos, nobis dolorum ipsam beatae obcaecati necessitatibus reiciendis id ullam earum voluptatem quia eos hic vel architecto culpa autem molestiae. Architecto, et ex voluptate esse ipsum ipsam fugit modi officiis recusandae magnam aperiam reprehenderit rem accusamus blanditiis porro placeat explicabo voluptatem nesciunt repellendus odio libero quaerat enim nisi? Illum suscipit architecto alias saepe ipsa ipsum cumque excepturi, nisi ex, eius id exercitationem vel dolorum a at deserunt, consequatur omnis et minus dicta magnam dolores? Et quas corrupti error inventore alias vero nam non! In consectetur sed dicta eius quasi laborum, est iusto, sit officia libero nobis nisi deserunt optio, ad odio praesentium. Est necessitatibus neque dicta praesentium sit?
    </div>
    <script>
        function setPositionByScroll(scrollPercent,svgElem){
            const pathElem = svgElem.querySelector('[data-path]')
            const planeGroup = svgElem.querySelector('[data-transform-group="plane"]')
            // const intersectionRatioToLength = (pathElem.current?.getTotalLength() ?? 0) * easeQuadOut((entry?.intersectionRatio ?? 0)) *0.9
            const percentToPathLength = pathElem.getTotalLength() * scrollPercent /100
            const d1 = percentToPathLength - 0.1
            const d2 = percentToPathLength + 0.1
            const newPos = pathElem.getPointAtLength(percentToPathLength) ?? { x: 0, y: 0 }
            const prevPos = pathElem.getPointAtLength(d1) ?? { x: 0, y: 0 }
            const nextPos = pathElem.getPointAtLength(d2) ?? { x: 0, y: 0 }
            const angle =  Math.atan2(nextPos.y - prevPos.y, nextPos.x - prevPos.x) * 180 / Math.PI
            let transformString = 'translate(' + newPos.x + ' ' + newPos.y + '),rotate(' + angle + ')'
            planeGroup.setAttribute('transform', transformString)
        }

        

        let referenceFrame = document.querySelector('[data-reference-frame]')
        let svgEleme = document.querySelector('[data-image-iteration="1"]')
        referenceFrame.addEventListener("scroll",function(e){
            
            // raw-dog get this svg top position inside the reference frame
            let refBox = referenceFrame.getBoundingClientRect()
            let svgBox = svgEleme.getBoundingClientRect()
            let scrollPercent = ((refBox.height - (svgBox.bottom - refBox.top)) / refBox.height) * 100
            // let scrollPercent = 
            console.log(scrollPercent,referenceFrame,svgEleme);
            setPositionByScroll(scrollPercent,svgEleme)
        })

        setPositionByScroll(100,svgEleme)
        //  (e) => {
        // }
    </script>
</body>
</html>